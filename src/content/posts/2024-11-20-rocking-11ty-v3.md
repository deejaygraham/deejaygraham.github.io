---
permalink: 2024/11/20/rocking-11ty-v3/
layout: post
title: Rocking 11ty v3
published: true
tags: [code, javascript, 11ty]
thumbnail: /img/thumbnails/eleventy-alt-420x255.png
alttext: 11ty
---

I was excited to see that the wonderful [11ty](https://www.11ty.dev) team had released the [next version](https://github.com/11ty/eleventy/releases/tag/v3.0.0). 
Since I was on version 2 for most of my sites,
I decided to upgrade this site as a test of the process and document some of the things I found in case I ever get around to dealing with the others (of course I will).

## Upgrade 

A big change is that 11ty now fully supports ESM, which is quite a big change, so it was nice to see that there is a new upgrade helper package. 
This hooks into the build process and tests for incompatibilities in your configuration. Working very much like eslint, the idea is you:

* install [the package](https://www.11ty.dev/docs/plugins/upgrade-help/) 
* import and add it to your eleventy configuration
* run a build as normal
* fix any errors
* uninstall the package
* commit changes
* profit !!!

For the most part, this was completely trouble free, first I changed my package.json to include ```type: module``` to make the switch to ESM. Next came the actual 
code changes which I thought would take me 10 minutes except I was forgetting about the parts *everywhere* in my code where I was using 
```module.exports = ``` and ```require()```. 

These changes applied to my custom filters, plugins, and shortcodes (as well as the tests for some of them), not forgetting the eleventy config itself so there was quite a 
bit to do. The upgrad helper helped identify these problems with a nice stack trace of the file causing the problem.


## Breakages

I did find some breaking changes I was not expecting. 

```javascript

/\*\*


```

## And I Forgot

I have a suite of [Cypress](https://cypress.io) end to end tests that I 
